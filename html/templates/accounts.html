<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Accounts</title>
  </head>
  <body>
    <form action="/accounts" method="get">
      <div>
        <label for="account">Account:</label>
        {{ $form := .Form }}
        <select name="account" multiple>
          {{ range .Accounts }}
            <option value="{{ .ID }}" {{ if contains $form.Accounts .ID }} selected {{ end }} >{{ .Number }}</option>
          {{ end }}
        </select>
      </div>
      <div>
        <label for="transaction_type">Type:</label>
        <select name="transaction_type" multiple>
          {{ if $form.Types }}
            <option value="1" {{ if contains $form.Types "1" }} selected {{ end }} >Credit</option>
            <option value="2" {{ if contains $form.Types "2" }} selected {{ end }} >Debit</option>
          {{ else }}
            <option value="1" selected>Credit</option>
            <option value="2" selected>Debit</option>
          {{ end }}
        </select>
      </div>
      <div>
        <label for="tags">Tags</label>
        <input type="text" name="tags" value="{{- range $index, $element := .Form.Tags -}}{{if $index}}, {{end}}{{ $element }} {{- end -}}">
      </div>
      <div>
        <label for="start">From</label>
        <input type="month" name="start" value="{{ .Form.Start }}">
      </div>
      <div>
        <label for="end">To</label>
        <input type="month" name="end" value="{{ .Form.End }}">
      </div>
      <input type="submit" value="Search" />
      <a href="/accounts">Reset</a>
    </form>
    <section>
      <header>
        <h2>Budget</h2>
      </header>
      <table>
        <thead>
          <tr>
            <th>Tag</th>
            <th>Planned</th>
            <th>Spent</th>
            <th>Transactions</th>
          </tr>
        </thead>
        <tbody>
          {{ range .Budgets }}
            <tr>
              <td>{{ .Tag }}</td>
              <td>{{ currency .Planned }}</td>
              <td>{{ currency .Spent }}</td>
              <td>{{ .Transactions }}</td>
            </tr>
          {{ end }}
        </tbody>
      </table>
    </section>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Name</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Tags</th>
          <th></th>
        </tr>
        <tr>
          <th colspan="5">{{ currency .Total }}</th>
        </tr>
      </thead>
      <tbody>
        {{ range .Transactions }}
        <tr>
          <td>
            {{ .Date.Format "Jan 02" }}
          </td>
          <td>
            {{ if .Alias }}
              {{ .Alias }}:
            {{ else }}
              {{ .Title }}:
            {{ end }}
          </td>
          <td>
            {{ .Type }}
          </td>
          <td>
            {{ currency .Amount }}
          </td>
          <td>
            {{- range $index, $element := .Tags -}}
              {{if $index}}, {{end}}
              {{ $element }}
            {{- end -}}
          </td>
          <td>
            <a href="/transactions/{{ .ID }}">Edit</a>
          </td>
        </tr>
        {{ end }}
      </tbody>
    </table>
  </body>
</html>
